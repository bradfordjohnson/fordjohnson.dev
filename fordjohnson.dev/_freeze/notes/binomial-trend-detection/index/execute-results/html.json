{
  "hash": "94a18840bd1e30d84651e082616c15e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\npagetitle: Binomial Trend Detection\ndescription: |\n  Explore a robust method for trend detection using binomial analysis, focusing on week-over-week comparisons to identify significant patterns in data.\nlightbox: true\nexecute: \n  freeze: auto\n---\n\n\n\n::: column-page\n# Binomial Trend Detection\n:::\n\n::::: column-screen\n:::: portfolio-banner\n::: column-page\nOne common approach to highlighting trends and detecting anomalies is **rolling average benchmarking**. This method involves comparing each new data point to the average of a specified number of preceding values. By smoothing out short-term fluctuations, it becomes easier to identify deviations that may indicate a potential trend shift or anomaly.\n\n<br>\n\nHowever, this method has some limitations. It is sensitive to the chosen window size, can introduce lag, and may struggle to account for seasonality or sudden changes in the data.\n:::\n::::\n:::::\n\n::: {.column-page .binom}\nAn alternative method to detect trends more robustly is a **binomial trend detection approach**, which uses a week-over-week (WoW) comparison. This is how the method can be implemented:\n\n| **Step** | **Details** |\n|----|----|\n| **Calculate WoW Deltas** | Compute the week-over-week changes (deltas) for the metric of interest. This involves determining whether the metric has increased or decreased each day. |\n| **Rolling 2-Week Window** | For each day, consider the previous 14-day period (2 weeks) as a rolling timeframe for analysis. This helps smooth out short-term variations while being responsive to recent changes. |\n| **Counting Positive and Negative Days** | Within the 14-day window, count the number of days where the WoW delta is positive and the number of days where it is negative. This provides insight into the recent performance pattern. |\n| **Binomial Distribution** | Assume that each day has an equal 50% chance of having either a positive or negative WoW delta. Under this assumption, the 14-day window is treated as 14 independent trials, each with a 50% probability of being positive or negative. |\n| **Trend Threshold** | Set a threshold to identify significant trends: for example, if 12 or more out of the 14 days show a consistent direction (either positive or negative), it is deemed statistically significant according to the binomial distribution. |\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom.test(12, 14, 1/2, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  12 and 14\nnumber of successes = 12, number of trials = 14, p-value = 0.00647\nalternative hypothesis: true probability of success is greater than 0.5\n95 percent confidence interval:\n 0.6146103 1.0000000\nsample estimates:\nprobability of success \n             0.8571429 \n```\n\n\n:::\n:::\n\n\n\nThis threshold helps ensure that the observed trend is not due to random fluctuations, but rather indicates a consistent pattern.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(ggplot2)\nlibrary(showtext)\nlibrary(ggtext)\n\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\nfont_add_google(name = \"Roboto\", family = \"Roboto\")\nfont_1 <- \"Roboto\"\n\nn <- 14 \np <- 1/2  \nx_obs <- 12  \n\nbinom_test <- binom.test(x_obs, n, p, alternative = \"greater\")\n\np_value <- binom_test$p.value\nconf_int <- binom_test$conf.int\n\np_ge_x_obs <- sum(dbinom(x_obs:n, size = n, prob = p))\n\ndata <- data.frame(\n  x = 0:n,\n  probability = dbinom(0:n, size = n, prob = p),\n  color = ifelse(0:n >= x_obs, \"#C0392B\", \"#30394F\")  \n)\n\nbinom_visual <- ggplot(data, aes(x = x, y = probability, fill = color)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_identity() +  \n  scale_x_continuous(breaks = 0:n) +  \n  labs(\n    title = \"Binomial Distribution (n = 14, p = 0.5)\",\n    subtitle = \"Success threshold ≥ 12 trials (days)\",\n    x = \"Number of Successes\",\n    y = \"Probability\"\n  ) +\n  theme_minimal() +\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.margin = margin(10, 10, 10, 10, \"mm\"),\n    axis.text = element_text(family = font_1, size = 7),\n    axis.title = element_text(family = font_1, size = 7),\n    axis.title.x = element_text(margin = margin(5, 0, 0, 0, 'mm')),\n    axis.title.y = element_text(margin = margin(0, 5, 0, 0, 'mm')),\n    plot.title = element_text(family = font_1, size = 10),\n    plot.subtitle = element_text(family = font_1, size = 8)\n  ) +\n  annotate(\n    geom = 'richtext',\n    x = n,\n    y = max(data$probability) * 0.9,\n    label = paste0(\n      \"<span style='color:#C0392B; font-size:8pt;font-family:Roboto;'>\",\n      \"P(X ≥ \", x_obs, \") = \", round(p_ge_x_obs, 4), \"<br>\",\n      \"95% CI = [\", round(conf_int[1], 4), \", \", round(conf_int[2], 4), \"]</span>\"),\n    hjust = 1, fill = NA, label.color = NA\n  )\n```\n:::\n\n\n\n:::\n\n\n\n::: {.cell .fig-column-page lightbox='{\"group\":\"plot\"}'}\n::: {.cell-output-display}\n![](index_files/figure-html/binom-visual-2-1.png){width=672}\n:::\n:::\n\n\n\n::: {.column-page .binom}\nThis binomial approach balances longer rolling windows, reduces sensitivity to day-of-week variations, and adjusts to recent trends more effectively than simple rolling averages.\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}